---
title: Office Ratings
author: ~
date: '2020-12-07'
slug: office-ratings
categories: []
tags: []
---

```{r include = FALSE}
library(here)
library(ggplot2)
library(tidyverse)
library(readxl)
library(schrute)
knitr::opts_chunk$set(echo = FALSE, tidy = TRUE)
```
# Office Ratings

For this project, I am going to be looking at Office Ratings data set contained in the library "schrute" which I installed through R. This data set contains ratings of each episode from the famous US adapted sitcom television series. The data has 55,130 observation and 12 variables. The variable season tells us which season of the show is being selected from. The variable episode tells us which episode of the season is being selected. The variable episode_name tells us the name of the episode. The variable director and writer tells us the director and writer of the episode, respectively. The variable character displays the cahracter that is speaking, and the variable text shows what they said. The variable imdb_rating tell us the rating given for the episode by imdb. The variable total_votes tells us how many people contributed to the imdb_rating; and finally, the variable air_data tells us when that specific episode was aired.

Here is a preview of the data set I am using...

```{r}
dat1 <- schrute::theoffice
glimpse(dat1)
```

# Question 1:
What are the five highest rated episode?

```{r}
results <- dat1 %>%
  select(episode_name, imdb_rating, season, episode) %>%
  group_by(episode_name, season, episode) %>%
  summarise(max_rating = max(imdb_rating, na.rm = TRUE)) %>%
  arrange(desc(max_rating))

results[1:5,]
```

# Question 2:
Have the ratings of the seasons changed over time? 

```{r}
season_stats <- dat1 %>%
  group_by(season) %>%
  summarise(mean_rating = mean(imdb_rating))

ggplot(season_stats, aes(x = season, y = mean_rating)) + 
  geom_line() +
  ggtitle("The Office Season Ratings") +
  xlab("Season") +
  ylab("Rating") +
  scale_x_continuous(breaks=seq(1,10,1)) +
  scale_y_continuous(limits=c(7.5,9))
```

# Question 3:
Which season contains the highest average rating?

```{r}
season_stats <- dat1 %>%
  group_by(season) %>%
  summarise(mean_rating = mean(imdb_rating)) %>%
  arrange(desc(mean_rating))

season_stats[1,]
```

# Question 4:
What are the most reoccuring words throughout the show? Which characters talk the most throughout the show?

To find the most reoccuring words we must first split the column "text" containing dialogue from the characters into seperate individual strings so then we can then place a count function to count each of the individual words that are spoken.

```{r}
reoccuring_words <- dat1 %>%
  
```

```{r}
most_spoken <- dat1 %>%
  group_by(character) %>%
  summarise(count = n()) %>%
  mutate(in_graph = count>250) %>%
  filter(in_graph == TRUE)

ggplot(most_spoken, aes(x = character, y = count)) +
  geom_bar(stat = "identity") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ggtitle("Most Spoken Characters in the Office") +
  xlab("Character") +
  ylab("Count")
```




